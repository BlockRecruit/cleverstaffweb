<div class="container-fluid mailing-detail">
    <div class="row">
        <div class="col-lg-12 block-header">
            <h4 translate="Adding recipients from a vacancy"></h4>
            <i class="fa fa-info-circle tooltip-icon" title="" tooltip-placement="top-left" tooltip-class="tooltip-outer" uib-tooltip-html="$root.tooltips.mailingAddFromJob" aria-hidden="true"></i>
        </div>
        <div class="col-lg-6 col-md-6">
            <input mailing-vacancy-autocompleter ng-model="someModel" ng-model-options="{debounce: 1000}" id="vacancyAutocomplete ">
        </div>
        <div class="col-lg-6 col-md-6" mailing-fetch-candidates statuses="VacancyStatusFiltered" vacancy-id="{{vacancy.id}}" local-id="{{vacancy.localId}}" candidates="candidatesForMailing"></div>
    </div>
    <div class="row candidates-table">
        <div class="col-lg-12 block-header">
            <h4 translate="List"></h4>
            <div class="top-buttons-block pull-right" ng-show="candidatesForMailing.length > 10">
                <button class="cancel-button" history-back translate="cancel"></button>
                <button class="orange-button" ng-click="toTheEditor()" ng-show="candidatesForMailing.length > 0" translate="Next"></button>
            </div>
            <div class="pull-right empty-emails alert alert-danger" ng-show="emptyEmails.count > 0">
                <span translate="There are candidate in the list without email" ng-show="emptyEmails.translateType === 0"></span>
                <span translate="There are candidates in the list without email" translate-values="{count: emptyEmails.count}" ng-show="emptyEmails.translateType === 1"></span>
                <span translate="There are candidates in the list without email _1" translate-values="{count: emptyEmails.count}" ng-show="emptyEmails.translateType === 2"></span>
                <a href="" translate="Delete him" ng-click="deleteCandidatesWithoutEmails()" ng-show="emptyEmails.translateType === 0"></a>
                <a href="" translate="Delete them" ng-click="deleteCandidatesWithoutEmails()" ng-show="emptyEmails.translateType !== 0"></a>
            </div>
        </div>
        <div class="col-lg-12 outer-block">
            <table class="table" id="mainTable" >
                <thead>
                    <tr>
                        <!--<th>-->
                            <!--<input type="checkbox" ng-model="allChecked" ng-change="checkAll()">-->
                        <!--</th>-->
                        <th class="full-name" translate="full_name">
                        </th>
                        <th class="email" translate="email">
                        </th>
                        <th class="recipient">
                            <img src="/images/sprite/icons/add-recipient.png" title="{{'Add a recipient'|translate}}" ng-click="addRecipientModal()">
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="candidate in candidatesForMailing track by $index"
                        ng-class="{
                                    'wrongEmail': candidate.wrongEmail,
                                    'changesNotSaved': candidate.editable && changesNotSaved,
                                    'duplicates': candidate.candidateId.email && !candidate.wrongEmail && ((candidatesForMailing[$index+1] && (candidatesForMailing[$index+1].candidateId.email === candidate.candidateId.email)) || (candidatesForMailing[$index-1] && (candidatesForMailing[$index-1].candidateId.email === candidate.candidateId.email))),
                                    'first-duplicate':  ($index === 0 || candidatesForMailing[$index-1].candidateId.email !== candidate.candidateId.email),
                                    'last-duplicate':  ($last || candidatesForMailing[$index+1].candidateId.email !== candidate.candidateId.email)
                                   }">

                        <!--<td class="received clickable">-->
                            <!--<input type="checkbox" ng-model="candidate.mailing" ng-click="candidateCheckbox(candidate)">-->
                        <!--</td>-->
                        <td class="recipient">
                            <span data-title="'PREVIEW'" priview pageid="candidate_pages" candidate="candidate.candidateId" class="preview-candidate-mailing">
                                    <i  candidate="user" title="{{'Profile preview'|translate}}" class="fa fa-address-card-o text_change" aria-hidden="true"></i>
                            </span>
                            <a href="!#/candidates/{{candidate.candidateId.localId}}" target="_blank" ng-if="!candidate.editable">{{candidate.candidateId.fullName|limitTo:40}}{{candidate.candidateId.fullName.length > 40 ? '...':''}}</a>
                            <input ng-if="candidate.editable" class="form-control" ng-init="candidate.candidateId.fullNameNew = candidate.candidateId.fullName" ng-model="candidate.candidateId.fullNameNew" type="text" maxlength="100">
                        </td>
                        <td class="email">
                            <span ng-if="!candidate.editable && candidate.candidateId.email" ng-bind="candidate.candidateId.email" ng-click="candidate.editable = true"></span>
                            <span ng-if="!candidate.editable && !candidate.candidateId.email" translate="Email is not specified" class="no-email" ng-click="candidate.editable = true"></span>
                            <input ng-if="candidate.editable" class="form-control" ng-init="candidate.candidateId.emailNew = candidate.candidateId.email" ng-model="candidate.candidateId.emailNew" type="text" maxlength="100" click-on-enter="#{{candidate.candidateId.localId}}">
                        </td>
                        <td class="send ">
                            <a title="{{'Delete'|translate}}" href="" ng-hide="candidate.editable" ng-click="confirmDelete(candidate.candidateId)" class="pull-right ng-scope edit-test">
                                <i class="fa fa-times" aria-hidden="true"></i>
                            </a>
                            <a href="" class="pull-right ng-binding edit-test" ng-hide="candidate.editable" title="{{'Edit'| translate}}" ng-click="candidate.editable = true">
                                <i class="fa fa-pencil" title="{{'Edit'|translate}}" aria-hidden="true"></i>
                            </a>
                            <button class="save-button btn" id="{{candidate.candidateId.localId}}" ng-click="saveCandidateContacts(candidate.candidateId, candidate.candidateId.emailNew, candidate.candidateId.fullNameNew)" ng-class="{'show-item': candidate.editable}" translate="save"></button>
                            <button class="cancel-button btn" ng-click="cancelSavingCandidateContacts(candidate.candidateId.localId)" ng-show="candidate.editable" translate="cancel"></button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="col-lg-12" ng-show="candidatesForMailing.length == 0" ><h3 translate="No recipients" class="text-center"></h3></div>
    </div>
    <div class="row">
        <div class="col-lg-12 text-center">
            <div class="bottom-buttons-block">
                <button class="cancel-button" history-back translate="cancel"></button>
                <button class="orange-button" ng-click="toTheEditor()" ng-show="candidatesForMailing.length > 0" translate="Next"></button>
            </div>
        </div>
    </div>
</div>
<!--*****************Candidate preview*******************-->
<div ng-include="'partials/candidate-preview.html'"></div>